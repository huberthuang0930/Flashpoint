/**
 * California state boundary polygon (simplified for performance)
 * Coordinates in GeoJSON format: [lon, lat]
 * Sourced from USGS state boundaries, simplified to ~100 points
 */

export const CALIFORNIA_BOUNDARY: number[][][] = [
  [
    [-124.482003, 42.000709],
    [-124.415527, 41.998459],
    [-124.157303, 42.001709],
    [-123.827179, 42.005459],
    [-123.764427, 42.006959],
    [-123.233101, 42.006209],
    [-122.378494, 42.011459],
    [-121.037003, 41.995209],
    [-120.001274, 41.994959],
    [-119.996204, 40.264519],
    [-119.999474, 38.999519],
    [-120.001526, 38.000263],
    [-118.710026, 37.256519],
    [-118.455026, 37.037269],
    [-118.107776, 36.883769],
    [-117.635526, 36.642519],
    [-117.168526, 36.461519],
    [-116.918276, 36.360269],
    [-116.540276, 36.197519],
    [-116.095276, 36.028769],
    [-115.724526, 35.900019],
    [-115.530276, 35.826769],
    [-115.357776, 35.761519],
    [-115.109026, 35.682519],
    [-114.632276, 35.501769],
    [-114.631376, 35.002014],
    [-114.625876, 34.876014],
    [-114.443376, 34.708514],
    [-114.333126, 34.581014],
    [-114.137876, 34.268514],
    [-114.332626, 34.174514],
    [-114.468876, 34.113514],
    [-114.522876, 34.052514],
    [-114.719876, 33.943514],
    [-114.815876, 33.835514],
    [-114.647876, 33.590514],
    [-114.539626, 33.440514],
    [-114.463626, 33.297514],
    [-114.471626, 33.029514],
    [-114.524626, 32.845514],
    [-114.720626, 32.718514],
    [-117.126625, 32.534515],
    [-117.241875, 32.668265],
    [-117.270875, 32.751265],
    [-117.303875, 32.807265],
    [-117.324875, 32.842265],
    [-117.471875, 33.027265],
    [-117.698125, 33.358515],
    [-118.019125, 33.738515],
    [-118.412125, 34.026515],
    [-118.582375, 34.146515],
    [-119.218375, 34.414765],
    [-119.554375, 34.574765],
    [-119.880625, 34.721015],
    [-120.638375, 35.156015],
    [-121.405625, 35.685515],
    [-121.891875, 36.009765],
    [-121.989875, 36.064765],
    [-122.381125, 36.308765],
    [-122.516125, 36.383765],
    [-122.502125, 37.783765],
    [-122.952125, 38.108765],
    [-123.727125, 38.951015],
    [-123.831125, 39.830015],
    [-124.396125, 40.432015],
    [-124.178125, 41.143015],
    [-124.213125, 41.833015],
    [-124.532003, 42.000709],
    [-124.482003, 42.000709]
  ]
];

/**
 * Check if a point (lat, lon) is within California's boundaries
 */
export function isInCalifornia(lat: number, lon: number): boolean {
  // Quick bbox check first (fast rejection)
  if (lat < 32.5 || lat > 42.0 || lon < -124.5 || lon > -114.1) {
    return false;
  }

  // Ray-casting algorithm for point-in-polygon
  const polygon = CALIFORNIA_BOUNDARY[0];
  let inside = false;

  for (let i = 0, j = polygon.length - 1; i < polygon.length; j = i++) {
    const xi = polygon[i][1]; // lat
    const yi = polygon[i][0]; // lon
    const xj = polygon[j][1];
    const yj = polygon[j][0];

    const intersect =
      yi > lon !== yj > lon &&
      lat < ((xj - xi) * (lon - yi)) / (yj - yi) + xi;

    if (intersect) inside = !inside;
  }

  return inside;
}
